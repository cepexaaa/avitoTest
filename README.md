# Сервис автоматического распределения reviewers по PRs

### Что можно делать:
- Используй make файл для управления сервисом
- Чтобы Запустить сервис надо выполнить `make start`
- Остановить сервис можно `make stop`
- после запуска проекта можно подавать запросы через HTTP API (аналогично тому, как в test_api.sh)
- Для просмотра состояния DB можно воспользоваться командой `docker exec -it avitotest-postgres-1 psql -U postgres -d review_service`
- Для просмотра логов воспользуйся `docker-compose logs [api|postgres]`
- Чтобы запустить интеграционные тесты надо выполнить команду `DB_HOST=localhost DB_PORT=5433 DB_USER=postgres DB_PASSWORD=password go test -v ./internal/usecase/...` или `DB_HOST=localhost DB_PORT=5433 DB_USER=postgres DB_PASSWORD=password go test -v ./internal/repository/user/...` из корня проекта
- Есть отдельная конфигурация docker-compose, которая не запускает работу самого приложения, не занимает порт 8080 и позволяет тестировать отдельные компоненты `docker-compose -f docker-compose.test.yml up -d`



### Что выполнено:
- Используется база данных (Postgres) для хранения информации
- База данных используется через docker
- Написаны интеграционные тесты
- Выполнены основные условия
- e2e тестирование - запустить сервис (make start) и запустить тесты [test_api.sh](./test_api.sh)
- описана конфигурация [линтера](.golangci.yml)
- проведено нагрузочное тестирвоание (с результатми можно ознакомиться в [load_test.md](./load_test.md))


### Комментарии по реализации:
 1. Если при сохранения PR нету user, который явялется автором PR, то ничего не сохраняется и овзвращается ошибка. Автоматически сохранить user нельзя, так как единственная информация о нём - это его ID, которой не достаточно для создания сущности user. 
 2. В случае переназначения ревьюера, если нету кандидата в ревьюеры из команды, который ещё не состоит в этом ревью, то возвращается ошибка и никто не заменяется
 3. При повторном создании PR не происходит ошибки а обновляются данные на значения нового PR

